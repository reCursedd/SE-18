{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3766", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3766/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3766/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3766/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/3766", "id": 170844072, "node_id": "MDU6SXNzdWUxNzA4NDQwNzI=", "number": 3766, "title": "Tensorflow distributed RNN crashed on ProtoBuf when using 3*512 rnn. ", "user": {"login": "bixiongxu", "id": 20988542, "node_id": "MDQ6VXNlcjIwOTg4NTQy", "avatar_url": "https://avatars1.githubusercontent.com/u/20988542?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bixiongxu", "html_url": "https://github.com/bixiongxu", "followers_url": "https://api.github.com/users/bixiongxu/followers", "following_url": "https://api.github.com/users/bixiongxu/following{/other_user}", "gists_url": "https://api.github.com/users/bixiongxu/gists{/gist_id}", "starred_url": "https://api.github.com/users/bixiongxu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bixiongxu/subscriptions", "organizations_url": "https://api.github.com/users/bixiongxu/orgs", "repos_url": "https://api.github.com/users/bixiongxu/repos", "events_url": "https://api.github.com/users/bixiongxu/events{/privacy}", "received_events_url": "https://api.github.com/users/bixiongxu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 25, "created_at": "2016-08-12T10:34:37Z", "updated_at": "2016-10-03T18:24:16Z", "closed_at": "2016-10-03T18:24:15Z", "author_association": "NONE", "body_html": "<h3>Environment info</h3>\n<p>Operating System:<br>\nLinux XNLPEXP2 4.4.0-24-generic <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"115973401\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/43\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/43/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/43\">#43</a>-Ubuntu SMP Wed Jun 8 19:27:37 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux<br>\nAzure VM 8 cores, 56GB memory</p>\n<p>If installed from binary pip package, provide:<br>\npip 8.1.2 from /home/xubixiong/.local/lib/python2.7/site-packages (python 2.7)<br>\n0.10.0rc0</p>\n<h3>Steps to reproduce</h3>\n<ol>\n<li>Create 2_PS + 2_worker,</li>\n<li>Try 3 * 512 RNN, (I changed some code in rnn/translate to make it distributed), worker0 will 100% crash on some code related to TensorBuf and run global_step, the stack is at the end of this post, same everytime</li>\n<li>Smaller the RNN, make it 1*128, it works fine.</li>\n</ol>\n<h3>What have you tried?</h3>\n<ol>\n<li>tensorflow.python.framework.errors.UnavailableError is said to not used in the document.</li>\n<li>The crashing line is TensorBuffer* buf = tensorflow::TensorCApi::Buffer(src); in tensorflow/core/client/tensor_c_api.cc:</li>\n<li>I try to smaller the RNN size and layers, then there is no problem.</li>\n<li>Is it a known issue, I did find some issue relating to TensorBuf, but not the exactly same case.</li>\n</ol>\n<h3>Logs or other output that would be helpful</h3>\n<p>(If logs are large, please upload as attachment).<br>\nE tensorflow/core/client/tensor_c_api.cc:485]<br>\nTraceback (most recent call last):<br>\nFile \"/home/xubixiong/soulmate/intent_trainer/rnn/translate/translate.py\", line 346, in <br>\ntf.app.run()<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 30, in run<br>\nsys.exit(main(sys.argv))<br>\nFile \"/home/xubixiong/soulmate/intent_trainer/rnn/translate/translate.py\", line 343, in main<br>\ntrain()<br>\nFile \"/home/xubixiong/soulmate/intent_trainer/rnn/translate/translate.py\", line 215, in train<br>\nwith sv.managed_session(server.target, config=sess_config) as sess:<br>\nFile \"/usr/lib/python2.7/contextlib.py\", line 17, in <strong>enter</strong><br>\nreturn self.gen.next()<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/supervisor.py\", line 942, in managed_session<br>\nself.stop(close_summary_writer=close_summary_writer)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/supervisor.py\", line 768, in stop<br>\nstop_grace_period_secs=self._stop_grace_secs)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/coordinator.py\", line 357, in join<br>\nsix.reraise(*self._exc_info_to_raise)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/supervisor.py\", line 931, in managed_session<br>\nstart_standard_services=start_standard_services)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/supervisor.py\", line 683, in prepare_or_wait_for_session<br>\nself.start_standard_services(sess)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/supervisor.py\", line 624, in start_standard_services<br>\ncurrent_step = training_util.global_step(sess, self._global_step)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/training_util.py\", line 50, in global_step<br>\nreturn int(sess.run(global_step_tensor))<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 382, in run<br>\nrun_metadata_ptr)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 655, in _run<br>\nfeed_dict_string, options, run_metadata)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 723, in _do_run<br>\ntarget_list, options, run_metadata)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 743, in _do_call    raise type(e)(node_def, op, message)tensorflow.python.framework.errors.UnavailableError</p>", "body_text": "Environment info\nOperating System:\nLinux XNLPEXP2 4.4.0-24-generic #43-Ubuntu SMP Wed Jun 8 19:27:37 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux\nAzure VM 8 cores, 56GB memory\nIf installed from binary pip package, provide:\npip 8.1.2 from /home/xubixiong/.local/lib/python2.7/site-packages (python 2.7)\n0.10.0rc0\nSteps to reproduce\n\nCreate 2_PS + 2_worker,\nTry 3 * 512 RNN, (I changed some code in rnn/translate to make it distributed), worker0 will 100% crash on some code related to TensorBuf and run global_step, the stack is at the end of this post, same everytime\nSmaller the RNN, make it 1*128, it works fine.\n\nWhat have you tried?\n\ntensorflow.python.framework.errors.UnavailableError is said to not used in the document.\nThe crashing line is TensorBuffer* buf = tensorflow::TensorCApi::Buffer(src); in tensorflow/core/client/tensor_c_api.cc:\nI try to smaller the RNN size and layers, then there is no problem.\nIs it a known issue, I did find some issue relating to TensorBuf, but not the exactly same case.\n\nLogs or other output that would be helpful\n(If logs are large, please upload as attachment).\nE tensorflow/core/client/tensor_c_api.cc:485]\nTraceback (most recent call last):\nFile \"/home/xubixiong/soulmate/intent_trainer/rnn/translate/translate.py\", line 346, in \ntf.app.run()\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 30, in run\nsys.exit(main(sys.argv))\nFile \"/home/xubixiong/soulmate/intent_trainer/rnn/translate/translate.py\", line 343, in main\ntrain()\nFile \"/home/xubixiong/soulmate/intent_trainer/rnn/translate/translate.py\", line 215, in train\nwith sv.managed_session(server.target, config=sess_config) as sess:\nFile \"/usr/lib/python2.7/contextlib.py\", line 17, in enter\nreturn self.gen.next()\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/supervisor.py\", line 942, in managed_session\nself.stop(close_summary_writer=close_summary_writer)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/supervisor.py\", line 768, in stop\nstop_grace_period_secs=self._stop_grace_secs)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/coordinator.py\", line 357, in join\nsix.reraise(*self._exc_info_to_raise)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/supervisor.py\", line 931, in managed_session\nstart_standard_services=start_standard_services)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/supervisor.py\", line 683, in prepare_or_wait_for_session\nself.start_standard_services(sess)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/supervisor.py\", line 624, in start_standard_services\ncurrent_step = training_util.global_step(sess, self._global_step)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/training_util.py\", line 50, in global_step\nreturn int(sess.run(global_step_tensor))\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 382, in run\nrun_metadata_ptr)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 655, in _run\nfeed_dict_string, options, run_metadata)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 723, in _do_run\ntarget_list, options, run_metadata)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 743, in _do_call    raise type(e)(node_def, op, message)tensorflow.python.framework.errors.UnavailableError", "body": "### Environment info\n\nOperating System:\nLinux XNLPEXP2 4.4.0-24-generic #43-Ubuntu SMP Wed Jun 8 19:27:37 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux\nAzure VM 8 cores, 56GB memory\n\nIf installed from binary pip package, provide:\npip 8.1.2 from /home/xubixiong/.local/lib/python2.7/site-packages (python 2.7)\n0.10.0rc0\n### Steps to reproduce\n1. Create 2_PS + 2_worker, \n2. Try 3 \\* 512 RNN, (I changed some code in rnn/translate to make it distributed), worker0 will 100% crash on some code related to TensorBuf and run global_step, the stack is at the end of this post, same everytime\n3. Smaller the RNN, make it 1*128, it works fine. \n### What have you tried?\n1.  tensorflow.python.framework.errors.UnavailableError is said to not used in the document. \n2. The crashing line is TensorBuffer\\* buf = tensorflow::TensorCApi::Buffer(src); in tensorflow/core/client/tensor_c_api.cc:\n3. I try to smaller the RNN size and layers, then there is no problem. \n4. Is it a known issue, I did find some issue relating to TensorBuf, but not the exactly same case. \n### Logs or other output that would be helpful\n\n(If logs are large, please upload as attachment).\nE tensorflow/core/client/tensor_c_api.cc:485]\nTraceback (most recent call last):\n  File \"/home/xubixiong/soulmate/intent_trainer/rnn/translate/translate.py\", line 346, in <module>\n    tf.app.run()\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py\", line 30, in run\n    sys.exit(main(sys.argv))\n  File \"/home/xubixiong/soulmate/intent_trainer/rnn/translate/translate.py\", line 343, in main\n    train()\n  File \"/home/xubixiong/soulmate/intent_trainer/rnn/translate/translate.py\", line 215, in train\n    with sv.managed_session(server.target, config=sess_config) as sess:\n  File \"/usr/lib/python2.7/contextlib.py\", line 17, in **enter**\n    return self.gen.next()\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/supervisor.py\", line 942, in managed_session\n    self.stop(close_summary_writer=close_summary_writer)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/supervisor.py\", line 768, in stop\n    stop_grace_period_secs=self._stop_grace_secs)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/coordinator.py\", line 357, in join\n    six.reraise(*self._exc_info_to_raise)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/supervisor.py\", line 931, in managed_session\n    start_standard_services=start_standard_services)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/supervisor.py\", line 683, in prepare_or_wait_for_session\n    self.start_standard_services(sess)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/supervisor.py\", line 624, in start_standard_services\n    current_step = training_util.global_step(sess, self._global_step)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/training_util.py\", line 50, in global_step\n    return int(sess.run(global_step_tensor))\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 382, in run\n    run_metadata_ptr)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 655, in _run\n    feed_dict_string, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 723, in _do_run\n    target_list, options, run_metadata)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 743, in _do_call    raise type(e)(node_def, op, message)tensorflow.python.framework.errors.UnavailableError\n"}