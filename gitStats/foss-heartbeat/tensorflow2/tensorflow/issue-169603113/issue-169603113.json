{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3667", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3667/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3667/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/3667/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/3667", "id": 169603113, "node_id": "MDU6SXNzdWUxNjk2MDMxMTM=", "number": 3667, "title": "convert tf.cond to constants failed by convert_variables_to_constants.", "user": {"login": "leftstone2015", "id": 11816941, "node_id": "MDQ6VXNlcjExODE2OTQx", "avatar_url": "https://avatars2.githubusercontent.com/u/11816941?v=4", "gravatar_id": "", "url": "https://api.github.com/users/leftstone2015", "html_url": "https://github.com/leftstone2015", "followers_url": "https://api.github.com/users/leftstone2015/followers", "following_url": "https://api.github.com/users/leftstone2015/following{/other_user}", "gists_url": "https://api.github.com/users/leftstone2015/gists{/gist_id}", "starred_url": "https://api.github.com/users/leftstone2015/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/leftstone2015/subscriptions", "organizations_url": "https://api.github.com/users/leftstone2015/orgs", "repos_url": "https://api.github.com/users/leftstone2015/repos", "events_url": "https://api.github.com/users/leftstone2015/events{/privacy}", "received_events_url": "https://api.github.com/users/leftstone2015/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "yuanbyu", "id": 2342391, "node_id": "MDQ6VXNlcjIzNDIzOTE=", "avatar_url": "https://avatars1.githubusercontent.com/u/2342391?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yuanbyu", "html_url": "https://github.com/yuanbyu", "followers_url": "https://api.github.com/users/yuanbyu/followers", "following_url": "https://api.github.com/users/yuanbyu/following{/other_user}", "gists_url": "https://api.github.com/users/yuanbyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/yuanbyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yuanbyu/subscriptions", "organizations_url": "https://api.github.com/users/yuanbyu/orgs", "repos_url": "https://api.github.com/users/yuanbyu/repos", "events_url": "https://api.github.com/users/yuanbyu/events{/privacy}", "received_events_url": "https://api.github.com/users/yuanbyu/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "yuanbyu", "id": 2342391, "node_id": "MDQ6VXNlcjIzNDIzOTE=", "avatar_url": "https://avatars1.githubusercontent.com/u/2342391?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yuanbyu", "html_url": "https://github.com/yuanbyu", "followers_url": "https://api.github.com/users/yuanbyu/followers", "following_url": "https://api.github.com/users/yuanbyu/following{/other_user}", "gists_url": "https://api.github.com/users/yuanbyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/yuanbyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yuanbyu/subscriptions", "organizations_url": "https://api.github.com/users/yuanbyu/orgs", "repos_url": "https://api.github.com/users/yuanbyu/repos", "events_url": "https://api.github.com/users/yuanbyu/events{/privacy}", "received_events_url": "https://api.github.com/users/yuanbyu/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2016-08-05T13:06:51Z", "updated_at": "2017-02-06T22:51:55Z", "closed_at": "2017-02-06T22:51:55Z", "author_association": "NONE", "body_html": "<h3>Environment info</h3>\n<p>Operating System:<br>\nUbuntu 14.04.4 LTS</p>\n<p>If installed from binary pip package, provide:<br>\n0.9.0</p>\n<h3>Steps to reproduce</h3>\n<p>import tensorflow as tf<br>\nfrom tensorflow.python.framework.graph_util import convert_variables_to_constants</p>\n<p>def save_model(sess, output_node_names, path = \"predict.pb\"):<br>\noutput_list =  output_node_names<br>\noutput_graph_def = convert_variables_to_constants(sess, sess.graph_def, output_list)</p>\n<p>X1 = tf.Variable(1.)<br>\nX2 = tf.Variable(1.)</p>\n<p>cond_value = tf.Variable(True)<br>\n<strong>cond_result = tf.cond(cond_value, lambda: tf.assign(X1, 2.), lambda: tf.assign(X2, 2.), name=\"cond_result\")</strong><br>\nX3 = tf.add(X1, X2,\"X3\")</p>\n<p>with tf.Session() as sesh:<br>\nsesh.run(tf.initialize_all_variables())<br>\n#sesh.run(cond_result)<br>\nsave_model(sesh, [\"X3\",])</p>\n<h3>What have you tried?</h3>\n<ol>\n<li>Test above code, convert_variables_to_constants failed.</li>\n<li>If comment the line of tf.cond, call save model will be OK.</li>\n</ol>\n<h3>Logs or other output that would be helpful</h3>\n<p>(If logs are large, please upload as attachment).</p>\n<p>File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/graph_util.py\", line 226, in convert_variables_to_constants<br>\nreturned_variables = sess.run(variable_names)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 382, in run<br>\nrun_metadata_ptr)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 598, in _run<br>\nprocessed_fetches = self._process_fetches(fetches)<br>\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 553, in _process_fetches<br>\n'Tensor. (%s)' % (subfetch, fetch, str(e)))<br>\nValueError: Fetch argument u'cond_result/Assign/Switch:1:0' of u'cond_result/Assign/Switch:1:0' cannot be interpreted as a Tensor. (The name 'cond_result/Assign/Switch:1:0' looks a like a Tensor name, but is not a valid one. Tensor names must be of the form \"&lt;op_name&gt;:&lt;output_index&gt;\".)</p>\n<p>refer to: <a href=\"url\">https://github.com/tensorflow/tensorflow/issues/3287</a></p>", "body_text": "Environment info\nOperating System:\nUbuntu 14.04.4 LTS\nIf installed from binary pip package, provide:\n0.9.0\nSteps to reproduce\nimport tensorflow as tf\nfrom tensorflow.python.framework.graph_util import convert_variables_to_constants\ndef save_model(sess, output_node_names, path = \"predict.pb\"):\noutput_list =  output_node_names\noutput_graph_def = convert_variables_to_constants(sess, sess.graph_def, output_list)\nX1 = tf.Variable(1.)\nX2 = tf.Variable(1.)\ncond_value = tf.Variable(True)\ncond_result = tf.cond(cond_value, lambda: tf.assign(X1, 2.), lambda: tf.assign(X2, 2.), name=\"cond_result\")\nX3 = tf.add(X1, X2,\"X3\")\nwith tf.Session() as sesh:\nsesh.run(tf.initialize_all_variables())\n#sesh.run(cond_result)\nsave_model(sesh, [\"X3\",])\nWhat have you tried?\n\nTest above code, convert_variables_to_constants failed.\nIf comment the line of tf.cond, call save model will be OK.\n\nLogs or other output that would be helpful\n(If logs are large, please upload as attachment).\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/graph_util.py\", line 226, in convert_variables_to_constants\nreturned_variables = sess.run(variable_names)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 382, in run\nrun_metadata_ptr)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 598, in _run\nprocessed_fetches = self._process_fetches(fetches)\nFile \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 553, in _process_fetches\n'Tensor. (%s)' % (subfetch, fetch, str(e)))\nValueError: Fetch argument u'cond_result/Assign/Switch:1:0' of u'cond_result/Assign/Switch:1:0' cannot be interpreted as a Tensor. (The name 'cond_result/Assign/Switch:1:0' looks a like a Tensor name, but is not a valid one. Tensor names must be of the form \"<op_name>:<output_index>\".)\nrefer to: https://github.com/tensorflow/tensorflow/issues/3287", "body": "### Environment info\n\nOperating System:\nUbuntu 14.04.4 LTS\n\nIf installed from binary pip package, provide:\n0.9.0\n### Steps to reproduce\n\nimport tensorflow as tf\nfrom tensorflow.python.framework.graph_util import convert_variables_to_constants\n\ndef save_model(sess, output_node_names, path = \"predict.pb\"):\n    output_list =  output_node_names\n    output_graph_def = convert_variables_to_constants(sess, sess.graph_def, output_list)\n\nX1 = tf.Variable(1.)\nX2 = tf.Variable(1.)\n\ncond_value = tf.Variable(True)\n**cond_result = tf.cond(cond_value, lambda: tf.assign(X1, 2.), lambda: tf.assign(X2, 2.), name=\"cond_result\")**\nX3 = tf.add(X1, X2,\"X3\")\n\nwith tf.Session() as sesh:\n    sesh.run(tf.initialize_all_variables())\n    #sesh.run(cond_result)\n    save_model(sesh, [\"X3\",])\n### What have you tried?\n1. Test above code, convert_variables_to_constants failed.\n2.  If comment the line of tf.cond, call save model will be OK.\n### Logs or other output that would be helpful\n\n(If logs are large, please upload as attachment).\n\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/graph_util.py\", line 226, in convert_variables_to_constants\n    returned_variables = sess.run(variable_names)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 382, in run\n    run_metadata_ptr)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 598, in _run\n    processed_fetches = self._process_fetches(fetches)\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py\", line 553, in _process_fetches\n    'Tensor. (%s)' % (subfetch, fetch, str(e)))\nValueError: Fetch argument u'cond_result/Assign/Switch:1:0' of u'cond_result/Assign/Switch:1:0' cannot be interpreted as a Tensor. (The name 'cond_result/Assign/Switch:1:0' looks a like a Tensor name, but is not a valid one. Tensor names must be of the form \"<op_name>:<output_index>\".)\n\nrefer to: [https://github.com/tensorflow/tensorflow/issues/3287](url)\n"}