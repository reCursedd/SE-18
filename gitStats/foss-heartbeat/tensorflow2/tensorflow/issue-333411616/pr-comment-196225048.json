{"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/196225048", "pull_request_review_id": 129733853, "id": 196225048, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5NjIyNTA0OA==", "diff_hunk": "@@ -45,3 +57,47 @@ func TestOperationAttrs(t *testing.T) {\n \t\t}\n \t}\n }\n+\n+func TestOperationAttrsEmptyList(t *testing.T) {\n+\tattrs := map[string]interface{}{\n+\t\t\"dtype\": Float,\n+\t}\n+\n+\tg := NewGraph()\n+\top, err := g.AddOperation(OpSpec{\n+\t\tType:  \"Placeholder\",\n+\t\tName:  \"placeholder\",\n+\t\tAttrs: attrs,\n+\t})\n+\tif err != nil {\n+\t\tt.Fatal(err)\n+\t}\n+\n+\tname := \"foo\"\n+\tfor _, attrType := range attrTypes {\n+\t\ttestListAttribute(op, name, attrType, 0, 0)\n+\t\ttestListAttribute(op, name, attrType, 1, 0)\n+\t}\n+}\n+\n+func TestOperationAttrsEmptyScalar(t *testing.T) {", "path": "tensorflow/go/attrs_test.go", "position": null, "original_position": 46, "commit_id": "577b256460dfca4e7c429437dded48e76715fee7", "original_commit_id": "366b046bfb2baa035c56f497fbea8ed6dae9d482", "user": {"login": "asimshankar", "id": 16018, "node_id": "MDQ6VXNlcjE2MDE4", "avatar_url": "https://avatars2.githubusercontent.com/u/16018?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asimshankar", "html_url": "https://github.com/asimshankar", "followers_url": "https://api.github.com/users/asimshankar/followers", "following_url": "https://api.github.com/users/asimshankar/following{/other_user}", "gists_url": "https://api.github.com/users/asimshankar/gists{/gist_id}", "starred_url": "https://api.github.com/users/asimshankar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asimshankar/subscriptions", "organizations_url": "https://api.github.com/users/asimshankar/orgs", "repos_url": "https://api.github.com/users/asimshankar/repos", "events_url": "https://api.github.com/users/asimshankar/events{/privacy}", "received_events_url": "https://api.github.com/users/asimshankar/received_events", "type": "User", "site_admin": false}, "body": "I'm not quite seeing the value of this test. For all but the `Float` type attribute, `testScalarAttribute` will return an error because the underlying C API call will return a non-OK `TF_Status`. And we're ignoring the return value, and testing it twice (lines 100, 101).\r\n\r\nFor the list valued attributes, I see we're testing a bit more (that we don't take the address of the first element of an empty slice) but we're not testing that it returns the right value and only going through the early return path in the C API.\r\n\r\nI'm tempted to do away with these tests (and ideally replace them with ones where we actually test the various values, but I realize that will be a bit of a pain since we'll have to find operations for each attribute type).", "created_at": "2018-06-18T21:04:16Z", "updated_at": "2018-06-19T21:50:40Z", "html_url": "https://github.com/tensorflow/tensorflow/pull/20103#discussion_r196225048", "pull_request_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/20103", "author_association": "MEMBER", "_links": {"self": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/196225048"}, "html": {"href": "https://github.com/tensorflow/tensorflow/pull/20103#discussion_r196225048"}, "pull_request": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/20103"}}, "body_html": "<p>I'm not quite seeing the value of this test. For all but the <code>Float</code> type attribute, <code>testScalarAttribute</code> will return an error because the underlying C API call will return a non-OK <code>TF_Status</code>. And we're ignoring the return value, and testing it twice (lines 100, 101).</p>\n<p>For the list valued attributes, I see we're testing a bit more (that we don't take the address of the first element of an empty slice) but we're not testing that it returns the right value and only going through the early return path in the C API.</p>\n<p>I'm tempted to do away with these tests (and ideally replace them with ones where we actually test the various values, but I realize that will be a bit of a pain since we'll have to find operations for each attribute type).</p>", "body_text": "I'm not quite seeing the value of this test. For all but the Float type attribute, testScalarAttribute will return an error because the underlying C API call will return a non-OK TF_Status. And we're ignoring the return value, and testing it twice (lines 100, 101).\nFor the list valued attributes, I see we're testing a bit more (that we don't take the address of the first element of an empty slice) but we're not testing that it returns the right value and only going through the early return path in the C API.\nI'm tempted to do away with these tests (and ideally replace them with ones where we actually test the various values, but I realize that will be a bit of a pain since we'll have to find operations for each attribute type)."}