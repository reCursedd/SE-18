{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9908", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9908/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9908/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/9908/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/9908", "id": 228626351, "node_id": "MDExOlB1bGxSZXF1ZXN0MTIwNTM4NjE4", "number": 9908, "title": "Make possible to use static libraries generated by tfcompile in MSVC.", "user": {"login": "leandro-gracia-gil", "id": 8785797, "node_id": "MDQ6VXNlcjg3ODU3OTc=", "avatar_url": "https://avatars1.githubusercontent.com/u/8785797?v=4", "gravatar_id": "", "url": "https://api.github.com/users/leandro-gracia-gil", "html_url": "https://github.com/leandro-gracia-gil", "followers_url": "https://api.github.com/users/leandro-gracia-gil/followers", "following_url": "https://api.github.com/users/leandro-gracia-gil/following{/other_user}", "gists_url": "https://api.github.com/users/leandro-gracia-gil/gists{/gist_id}", "starred_url": "https://api.github.com/users/leandro-gracia-gil/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/leandro-gracia-gil/subscriptions", "organizations_url": "https://api.github.com/users/leandro-gracia-gil/orgs", "repos_url": "https://api.github.com/users/leandro-gracia-gil/repos", "events_url": "https://api.github.com/users/leandro-gracia-gil/events{/privacy}", "received_events_url": "https://api.github.com/users/leandro-gracia-gil/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false}], "state": "closed", "locked": false, "assignee": {"login": "tatatodd", "id": 5453737, "node_id": "MDQ6VXNlcjU0NTM3Mzc=", "avatar_url": "https://avatars3.githubusercontent.com/u/5453737?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tatatodd", "html_url": "https://github.com/tatatodd", "followers_url": "https://api.github.com/users/tatatodd/followers", "following_url": "https://api.github.com/users/tatatodd/following{/other_user}", "gists_url": "https://api.github.com/users/tatatodd/gists{/gist_id}", "starred_url": "https://api.github.com/users/tatatodd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tatatodd/subscriptions", "organizations_url": "https://api.github.com/users/tatatodd/orgs", "repos_url": "https://api.github.com/users/tatatodd/repos", "events_url": "https://api.github.com/users/tatatodd/events{/privacy}", "received_events_url": "https://api.github.com/users/tatatodd/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tatatodd", "id": 5453737, "node_id": "MDQ6VXNlcjU0NTM3Mzc=", "avatar_url": "https://avatars3.githubusercontent.com/u/5453737?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tatatodd", "html_url": "https://github.com/tatatodd", "followers_url": "https://api.github.com/users/tatatodd/followers", "following_url": "https://api.github.com/users/tatatodd/following{/other_user}", "gists_url": "https://api.github.com/users/tatatodd/gists{/gist_id}", "starred_url": "https://api.github.com/users/tatatodd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tatatodd/subscriptions", "organizations_url": "https://api.github.com/users/tatatodd/orgs", "repos_url": "https://api.github.com/users/tatatodd/repos", "events_url": "https://api.github.com/users/tatatodd/events{/privacy}", "received_events_url": "https://api.github.com/users/tatatodd/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2017-05-15T07:22:57Z", "updated_at": "2017-05-16T16:56:09Z", "closed_at": "2017-05-16T16:56:09Z", "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/9908", "html_url": "https://github.com/tensorflow/tensorflow/pull/9908", "diff_url": "https://github.com/tensorflow/tensorflow/pull/9908.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/9908.patch"}, "body_html": "<p>Currently it is possible to generate MSVC-compatible static libraries from a<br>\nLinux build of tfcompile using the target triple \"x86_64-pc-windows-msvc\".</p>\n<p>However, just linking such library does not work out-of-the-box because of a<br>\ntrivial class -&gt; struct issue that becomes a compiler error in MSVC and because<br>\nmultiple other symbols are missing.</p>\n<p>The files defining these symbols must be manually built into the MSVC project,<br>\nbut many have minor incompatibilities that prevent them to be built.</p>\n<p>This patch makes a few minor modifications to these files, making it possible<br>\nto link and run Tensorflow graphs generated with tfcompile in MSVC in Windows.</p>\n<p>The files that might need to be built into the MSVC project are as follows:</p>\n<ol>\n<li>For symbols required by the generated headers.</li>\n</ol>\n<ul>\n<li>tensorflow/compiler/aot/runtime.cc</li>\n<li>tensorflow/compiler/xla/executable_run_options.cc</li>\n</ul>\n<ol start=\"2\">\n<li>For symbols that provide custom XLA operations.</li>\n</ol>\n<ul>\n<li>tensorflow/compiler/tf2xla/kernels/gather_op_kernel_float_int32.cc</li>\n<li>tensorflow/compiler/tf2xla/kernels/gather_op_kernel_float_int64.cc</li>\n<li>tensorflow/compiler/tf2xla/kernels/index_ops_kernel_argmax_float_1d.cc</li>\n<li>tensorflow/compiler/tf2xla/kernels/index_ops_kernel_argmax_float_2d.cc</li>\n</ul>\n<ol start=\"3\">\n<li>For symbols required by SimpleResolver in xla/service/cpu/simple_orc_jit.cc.</li>\n</ol>\n<ul>\n<li>tensorflow/compiler/xla/service/cpu/runtime_matmul.cc</li>\n<li>tensorflow/compiler/xla/service/cpu/runtime_single_threaded_matmul.cc</li>\n<li>tensorflow/compiler/xla/service/cpu/runtime_conv2d.cc</li>\n<li>tensorflow/compiler/xla/service/cpu/runtime_single_threaded_conv2d.cc</li>\n<li>tensorflow/compiler/xla/service/cpu/cpu_runtime.cc</li>\n</ul>\n<p>Additionally, the following files might also required by SimpleResolver, but are<br>\nnot included in this patch because there is no simple alternative to<br>\n<strong>attribute</strong>((vector_size(x))) and <strong>attribute</strong>((weak)) in MSVC.</p>\n<ul>\n<li>tensorflow/compiler/xla/service/cpu/cpu_runtime_sse4_1.cc</li>\n<li>tensorflow/compiler/xla/service/cpu/cpu_runtime_avx.cc</li>\n</ul>\n<p>See <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load issue title\" data-id=\"213555554\" data-permission-text=\"Issue title is private\" data-url=\"https://github.com/tensorflow/tensorflow/issues/8310\" data-hovercard-type=\"issue\" data-hovercard-url=\"/tensorflow/tensorflow/issues/8310/hovercard\" href=\"https://github.com/tensorflow/tensorflow/issues/8310\">#8310</a> for more information.</p>", "body_text": "Currently it is possible to generate MSVC-compatible static libraries from a\nLinux build of tfcompile using the target triple \"x86_64-pc-windows-msvc\".\nHowever, just linking such library does not work out-of-the-box because of a\ntrivial class -> struct issue that becomes a compiler error in MSVC and because\nmultiple other symbols are missing.\nThe files defining these symbols must be manually built into the MSVC project,\nbut many have minor incompatibilities that prevent them to be built.\nThis patch makes a few minor modifications to these files, making it possible\nto link and run Tensorflow graphs generated with tfcompile in MSVC in Windows.\nThe files that might need to be built into the MSVC project are as follows:\n\nFor symbols required by the generated headers.\n\n\ntensorflow/compiler/aot/runtime.cc\ntensorflow/compiler/xla/executable_run_options.cc\n\n\nFor symbols that provide custom XLA operations.\n\n\ntensorflow/compiler/tf2xla/kernels/gather_op_kernel_float_int32.cc\ntensorflow/compiler/tf2xla/kernels/gather_op_kernel_float_int64.cc\ntensorflow/compiler/tf2xla/kernels/index_ops_kernel_argmax_float_1d.cc\ntensorflow/compiler/tf2xla/kernels/index_ops_kernel_argmax_float_2d.cc\n\n\nFor symbols required by SimpleResolver in xla/service/cpu/simple_orc_jit.cc.\n\n\ntensorflow/compiler/xla/service/cpu/runtime_matmul.cc\ntensorflow/compiler/xla/service/cpu/runtime_single_threaded_matmul.cc\ntensorflow/compiler/xla/service/cpu/runtime_conv2d.cc\ntensorflow/compiler/xla/service/cpu/runtime_single_threaded_conv2d.cc\ntensorflow/compiler/xla/service/cpu/cpu_runtime.cc\n\nAdditionally, the following files might also required by SimpleResolver, but are\nnot included in this patch because there is no simple alternative to\nattribute((vector_size(x))) and attribute((weak)) in MSVC.\n\ntensorflow/compiler/xla/service/cpu/cpu_runtime_sse4_1.cc\ntensorflow/compiler/xla/service/cpu/cpu_runtime_avx.cc\n\nSee #8310 for more information.", "body": "Currently it is possible to generate MSVC-compatible static libraries from a\r\nLinux build of tfcompile using the target triple \"x86_64-pc-windows-msvc\".\r\n\r\nHowever, just linking such library does not work out-of-the-box because of a\r\ntrivial class -> struct issue that becomes a compiler error in MSVC and because\r\nmultiple other symbols are missing.\r\n\r\nThe files defining these symbols must be manually built into the MSVC project,\r\nbut many have minor incompatibilities that prevent them to be built.\r\n\r\nThis patch makes a few minor modifications to these files, making it possible\r\nto link and run Tensorflow graphs generated with tfcompile in MSVC in Windows.\r\n\r\nThe files that might need to be built into the MSVC project are as follows:\r\n\r\n1. For symbols required by the generated headers.\r\n - tensorflow/compiler/aot/runtime.cc\r\n - tensorflow/compiler/xla/executable_run_options.cc\r\n\r\n2. For symbols that provide custom XLA operations.\r\n - tensorflow/compiler/tf2xla/kernels/gather_op_kernel_float_int32.cc\r\n - tensorflow/compiler/tf2xla/kernels/gather_op_kernel_float_int64.cc\r\n - tensorflow/compiler/tf2xla/kernels/index_ops_kernel_argmax_float_1d.cc\r\n - tensorflow/compiler/tf2xla/kernels/index_ops_kernel_argmax_float_2d.cc\r\n\r\n3. For symbols required by SimpleResolver in xla/service/cpu/simple_orc_jit.cc.\r\n - tensorflow/compiler/xla/service/cpu/runtime_matmul.cc\r\n - tensorflow/compiler/xla/service/cpu/runtime_single_threaded_matmul.cc\r\n - tensorflow/compiler/xla/service/cpu/runtime_conv2d.cc\r\n - tensorflow/compiler/xla/service/cpu/runtime_single_threaded_conv2d.cc\r\n - tensorflow/compiler/xla/service/cpu/cpu_runtime.cc\r\n\r\nAdditionally, the following files might also required by SimpleResolver, but are\r\nnot included in this patch because there is no simple alternative to\r\n__attribute__((vector_size(x))) and __attribute__((weak)) in MSVC.\r\n\r\n - tensorflow/compiler/xla/service/cpu/cpu_runtime_sse4_1.cc\r\n - tensorflow/compiler/xla/service/cpu/cpu_runtime_avx.cc\r\n\r\nSee https://github.com/tensorflow/tensorflow/issues/8310 for more information."}