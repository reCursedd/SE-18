{"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/177952410", "pull_request_review_id": 107924004, "id": 177952410, "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE3Nzk1MjQxMA==", "diff_hunk": "@@ -112,8 +112,10 @@ int main(int argc, char* argv[]) {\n   }\n   uint64 elapsed = env->NowMicros() - start;\n   LOG(INFO) << \"Loaded \" << AddCommas(offset) << \" bytes with \"\n-            << AddCommas(records) << \" records at \"\n-            << AddCommas(offset / (elapsed / 1000000)) << \" bps\";\n+            << AddCommas(records) << \" records\";\n+  if (elapsed > 0) {\n+    LOG(INFO) << \"bps=\" << (uint64)(offset / (elapsed / 1000000.0));", "path": "tensorflow/contrib/tensorboard/db/loader.cc", "position": null, "original_position": 8, "commit_id": "b621ac047e43540992b3ac0e9055b9e7225e74da", "original_commit_id": "584e3495b50db8fd0a894de8b6d85fcf4268a855", "user": {"login": "skambha", "id": 16563220, "node_id": "MDQ6VXNlcjE2NTYzMjIw", "avatar_url": "https://avatars3.githubusercontent.com/u/16563220?v=4", "gravatar_id": "", "url": "https://api.github.com/users/skambha", "html_url": "https://github.com/skambha", "followers_url": "https://api.github.com/users/skambha/followers", "following_url": "https://api.github.com/users/skambha/following{/other_user}", "gists_url": "https://api.github.com/users/skambha/gists{/gist_id}", "starred_url": "https://api.github.com/users/skambha/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/skambha/subscriptions", "organizations_url": "https://api.github.com/users/skambha/orgs", "repos_url": "https://api.github.com/users/skambha/repos", "events_url": "https://api.github.com/users/skambha/events{/privacy}", "received_events_url": "https://api.github.com/users/skambha/received_events", "type": "User", "site_admin": false}, "body": "Thank you for the review. I moved the bps to one log line like before and used the ternary as you suggest.\r\n\r\nI added a condition to report the bps only if elapsed is greater than 0  because it did not seem right to say bps of 0 if 'n' bytes were read and elapsed was 0. \r\n\r\nHow about I do this: \r\n`(elapsed == 0 ? offset : static_cast<uint64>(offset / (elapsed / 1000000.0)))`\r\n\r\nSo if elapsed is 0, we will report bps as the bytes read (ie offset) as that many bytes were processed in a sec. \r\n\r\n\u2014\u2014\u2014\u2014\r\nThe log line will look like as before: \r\n2018-03-28 21:02:17.282332: I tensorflow/contrib/tensorboard/db/loader.cc:114] Loaded 590,308 bytes with 29 records at 1907172 bps", "created_at": "2018-03-29T04:44:19Z", "updated_at": "2018-03-29T19:03:14Z", "html_url": "https://github.com/tensorflow/tensorflow/pull/17692#discussion_r177952410", "pull_request_url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/17692", "author_association": "CONTRIBUTOR", "_links": {"self": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/comments/177952410"}, "html": {"href": "https://github.com/tensorflow/tensorflow/pull/17692#discussion_r177952410"}, "pull_request": {"href": "https://api.github.com/repos/tensorflow/tensorflow/pulls/17692"}}, "body_html": "<p>Thank you for the review. I moved the bps to one log line like before and used the ternary as you suggest.</p>\n<p>I added a condition to report the bps only if elapsed is greater than 0  because it did not seem right to say bps of 0 if 'n' bytes were read and elapsed was 0.</p>\n<p>How about I do this:<br>\n<code>(elapsed == 0 ? offset : static_cast&lt;uint64&gt;(offset / (elapsed / 1000000.0)))</code></p>\n<p>So if elapsed is 0, we will report bps as the bytes read (ie offset) as that many bytes were processed in a sec.</p>\n<p>\u2014\u2014\u2014\u2014<br>\nThe log line will look like as before:<br>\n2018-03-28 21:02:17.282332: I tensorflow/contrib/tensorboard/db/loader.cc:114] Loaded 590,308 bytes with 29 records at 1907172 bps</p>", "body_text": "Thank you for the review. I moved the bps to one log line like before and used the ternary as you suggest.\nI added a condition to report the bps only if elapsed is greater than 0  because it did not seem right to say bps of 0 if 'n' bytes were read and elapsed was 0.\nHow about I do this:\n(elapsed == 0 ? offset : static_cast<uint64>(offset / (elapsed / 1000000.0)))\nSo if elapsed is 0, we will report bps as the bytes read (ie offset) as that many bytes were processed in a sec.\n\u2014\u2014\u2014\u2014\nThe log line will look like as before:\n2018-03-28 21:02:17.282332: I tensorflow/contrib/tensorboard/db/loader.cc:114] Loaded 590,308 bytes with 29 records at 1907172 bps", "in_reply_to_id": 177918056}